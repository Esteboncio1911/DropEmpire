<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DropEmpire - Abre Cajas y Gana Premios √âpicos</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #0a0e27;
            color: #fff;
            overflow-x: hidden;
        }

        .navbar {
            position: fixed;
            top: 0;
            width: 100%;
            background: rgba(10, 14, 39, 0.95);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
            border-bottom: 1px solid rgba(138, 43, 226, 0.3);
        }

        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            cursor: pointer;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
            list-style: none;
            align-items: center;
        }

        .nav-links a {
            color: #fff;
            text-decoration: none;
            transition: all 0.3s;
            font-weight: 500;
            cursor: pointer;
        }

        .nav-links a:hover {
            color: #667eea;
            text-shadow: 0 0 10px rgba(102, 126, 234, 0.8);
        }

        .user-balance {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.2), rgba(118, 75, 162, 0.2));
            padding: 0.5rem 1.5rem;
            border-radius: 50px;
            border: 1px solid rgba(102, 126, 234, 0.5);
            font-weight: bold;
            color: #4ade80;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 0.8rem 2rem;
            border-radius: 50px;
            border: none;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.6);
        }

        .btn-secondary {
            background: transparent;
            padding: 0.8rem 2rem;
            border-radius: 50px;
            border: 2px solid #667eea;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-secondary:hover {
            background: rgba(102, 126, 234, 0.1);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: linear-gradient(145deg, #1a1f3a 0%, #0f1329 100%);
            padding: 3rem;
            border-radius: 20px;
            border: 1px solid rgba(102, 126, 234, 0.3);
            max-width: 400px;
            width: 90%;
            text-align: center;
        }

        .modal-title {
            font-size: 2rem;
            margin-bottom: 2rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .input-group {
            margin-bottom: 1.5rem;
        }

        .input-group input {
            width: 100%;
            padding: 1rem;
            background: rgba(102, 126, 234, 0.1);
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 10px;
            color: white;
            font-size: 1rem;
        }

        .input-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .hero {
            min-height: 100vh;
            padding-top: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            position: relative;
            overflow: hidden;
            background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 100%);
        }

        .app-container {
            display: none;
            padding-top: 80px;
            min-height: 100vh;
        }

        .app-container.active {
            display: block;
        }

        .section-header {
            text-align: center;
            padding: 3rem 2rem;
            background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 100%);
        }

        .section-header h2 {
            font-size: 2.5rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .cases-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2rem;
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        .case-card {
            background: linear-gradient(145deg, #1a1f3a 0%, #0f1329 100%);
            border-radius: 20px;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid rgba(102, 126, 234, 0.3);
        }

        .case-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.4);
            border-color: #667eea;
        }

        .case-image {
            width: 100%;
            height: 200px;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.2), rgba(118, 75, 162, 0.2));
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1rem;
            font-size: 4rem;
        }

        .case-name {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .case-price {
            font-size: 1.5rem;
            color: #667eea;
            font-weight: bold;
            margin-bottom: 1rem;
        }

        .opening-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 3000;
            justify-content: center;
            align-items: center;
        }

        .opening-modal.active {
            display: flex;
        }

        .opening-container {
            width: 90%;
            max-width: 1200px;
        }

        .roulette-container {
            position: relative;
            height: 400px;
            overflow: hidden;
            background: linear-gradient(145deg, #1a1f3a 0%, #0f1329 100%);
            border-radius: 20px;
            margin-bottom: 2rem;
        }

        .roulette-line {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 4px;
            height: 100%;
            background: linear-gradient(to bottom, transparent, #667eea, transparent);
            z-index: 10;
            transform: translateX(-50%);
        }

        .roulette-items {
            display: flex;
            gap: 1rem;
            padding: 2rem;
            transition: transform 3s cubic-bezier(0.17, 0.67, 0.12, 0.99);
        }

        .roulette-item {
            min-width: 150px;
            height: 200px;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.2), rgba(118, 75, 162, 0.2));
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border: 2px solid rgba(102, 126, 234, 0.3);
            padding: 1rem;
        }

        .roulette-item.rare { border-color: #667eea; }
        .roulette-item.epic { border-color: #a855f7; }
        .roulette-item.legendary { border-color: #fbbf24; }

        .item-icon {
            font-size: 3rem;
            margin-bottom: 0.5rem;
        }

        .item-name {
            font-size: 0.9rem;
            text-align: center;
            margin-bottom: 0.3rem;
        }

        .item-value {
            color: #4ade80;
            font-weight: bold;
        }

        .result-container {
            text-align: center;
            padding: 2rem;
            background: linear-gradient(145deg, #1a1f3a 0%, #0f1329 100%);
            border-radius: 20px;
            display: none;
        }

        .result-container.active {
            display: block;
        }

        .result-item {
            font-size: 5rem;
            margin-bottom: 1rem;
        }

        .result-name {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .result-value {
            font-size: 2.5rem;
            color: #4ade80;
            font-weight: bold;
            margin-bottom: 2rem;
        }

        .battles-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        .battle-modes {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .battle-mode {
            background: linear-gradient(145deg, #1a1f3a 0%, #0f1329 100%);
            border-radius: 20px;
            padding: 2rem;
            border: 2px solid rgba(102, 126, 234, 0.3);
            cursor: pointer;
            transition: all 0.3s;
        }

        .battle-mode:hover {
            border-color: #667eea;
            transform: translateY(-5px);
        }

        .battle-arena {
            background: linear-gradient(145deg, #1a1f3a 0%, #0f1329 100%);
            border-radius: 20px;
            padding: 2rem;
            border: 2px solid rgba(102, 126, 234, 0.3);
        }

        .battle-players {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 2rem;
            align-items: center;
            margin-bottom: 2rem;
        }

        .player-side {
            text-align: center;
        }

        .player-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            margin: 0 auto 1rem;
        }

        .vs-text {
            font-size: 3rem;
            font-weight: bold;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .upgrade-container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem;
        }

        .upgrade-area {
            background: linear-gradient(145deg, #1a1f3a 0%, #0f1329 100%);
            border-radius: 20px;
            padding: 3rem;
            border: 2px solid rgba(102, 126, 234, 0.3);
        }

        .upgrade-slots {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 2rem;
            align-items: center;
            margin-bottom: 2rem;
        }

        .upgrade-slot {
            background: rgba(102, 126, 234, 0.1);
            border: 2px dashed rgba(102, 126, 234, 0.3);
            border-radius: 15px;
            padding: 2rem;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .upgrade-arrow {
            font-size: 3rem;
            color: #667eea;
        }

        .success-rate {
            text-align: center;
            margin-bottom: 2rem;
        }

        .success-bar {
            width: 100%;
            height: 30px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 15px;
            overflow: hidden;
            margin-top: 1rem;
        }

        .success-fill {
            height: 100%;
            background: linear-gradient(90deg, #4ade80, #667eea);
            transition: width 0.3s;
        }

        .inventory-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 1rem;
            padding: 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        .inventory-item {
            background: linear-gradient(145deg, #1a1f3a 0%, #0f1329 100%);
            border-radius: 15px;
            padding: 1rem;
            border: 2px solid rgba(102, 126, 234, 0.3);
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .inventory-item:hover {
            transform: scale(1.05);
            border-color: #667eea;
        }

        .inventory-item.selected {
            border-color: #4ade80;
            background: rgba(74, 222, 128, 0.1);
        }

        @media (max-width: 768px) {
            .nav-links { gap: 1rem; font-size: 0.9rem; }
            .cases-grid { grid-template-columns: 1fr; }
            .battle-players { grid-template-columns: 1fr; }
            .vs-text { margin: 1rem 0; }
            .upgrade-slots { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="logo" onclick="showHome()">üíé DROPEMPIRE</div>
        <ul class="nav-links" id="nav-menu" style="display: none;">
            <li><a onclick="showSection('cases')">Cajas</a></li>
            <li><a onclick="showSection('battles')">Batallas</a></li>
            <li><a onclick="showSection('upgrade')">Upgrade</a></li>
            <li><a onclick="showSection('inventory')">Inventario</a></li>
            <li class="user-balance" id="user-balance">$0.00</li>
        </ul>
        <button class="btn-primary" id="login-btn" onclick="showLoginModal()">Iniciar Sesi√≥n</button>
        <button class="btn-primary" id="logout-btn" onclick="logout()" style="display: none;">Cerrar Sesi√≥n</button>
    </nav>

    <div class="modal" id="login-modal">
        <div class="modal-content">
            <h2 class="modal-title">üéÆ Iniciar Sesi√≥n</h2>
            <div class="input-group">
                <input type="text" id="username" placeholder="Nombre de usuario">
            </div>
            <div class="input-group">
                <input type="password" id="password" placeholder="Contrase√±a">
            </div>
            <button class="btn-primary" onclick="login()" style="width: 100%; margin-bottom: 1rem;">Entrar</button>
            <button class="btn-secondary" onclick="register()" style="width: 100%;">Registrarse</button>
            <p style="margin-top: 1rem; color: #8b8ba7; font-size: 0.9rem;">üéÅ Bono de bienvenida: $5,000</p>
        </div>
    </div>

    <div class="opening-modal" id="opening-modal">
        <div class="opening-container">
            <div class="roulette-container">
                <div class="roulette-line"></div>
                <div class="roulette-items" id="roulette-items"></div>
            </div>
            <div class="result-container" id="result-container">
                <div class="result-item" id="result-icon"></div>
                <div class="result-name" id="result-name"></div>
                <div class="result-value" id="result-value"></div>
                <button class="btn-primary" onclick="closeOpening()">Continuar</button>
            </div>
        </div>
    </div>

    <section class="hero" id="home-section">
        <div style="text-align: center; z-index: 1; position: relative;">
            <h1 style="font-size: 4rem; margin-bottom: 1rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">ABRE CAJAS √âPICAS</h1>
            <p style="font-size: 1.3rem; margin-bottom: 2rem; color: #b8b8d4;">Gana skins legendarios, art√≠culos exclusivos y premios incre√≠bles</p>
            <button class="btn-primary" onclick="showLoginModal()" style="font-size: 1.2rem; padding: 1rem 3rem;">COMENZAR AHORA</button>
        </div>
    </section>

    <div class="app-container" id="cases-section">
        <div class="section-header">
            <h2>üéÅ ABRIR CAJAS</h2>
        </div>
        <div class="cases-grid" id="cases-grid"></div>
    </div>

    <div class="app-container" id="battles-section">
        <div class="section-header">
            <h2>‚öîÔ∏è BATALLAS</h2>
        </div>
        <div class="battles-container">
            <div class="battle-modes">
                <div class="battle-mode" onclick="startBattle('1v1')">
                    <h3 style="color: #667eea; margin-bottom: 1rem;">üéØ 1 vs 1</h3>
                    <p style="color: #b8b8d4;">Enfr√©ntate a otro jugador</p>
                </div>
                <div class="battle-mode" onclick="startBattle('2v2')">
                    <h3 style="color: #667eea; margin-bottom: 1rem;">üë• 2 vs 2</h3>
                    <p style="color: #b8b8d4;">Batalla en equipos</p>
                </div>
                <div class="battle-mode" onclick="startBattle('royal')">
                    <h3 style="color: #667eea; margin-bottom: 1rem;">üëë Royal</h3>
                    <p style="color: #b8b8d4;">Hasta 4 jugadores</p>
                </div>
            </div>
            <div class="battle-arena" id="battle-arena" style="display: none;"></div>
        </div>
    </div>

    <div class="app-container" id="upgrade-section">
        <div class="section-header">
            <h2>‚¨ÜÔ∏è UPGRADE</h2>
        </div>
        <div class="upgrade-container">
            <div class="upgrade-area">
                <div class="upgrade-slots">
                    <div class="upgrade-slot" id="item-slot">
                        <p style="color: #8b8ba7;">Selecciona un item de tu inventario</p>
                    </div>
                    <div class="upgrade-arrow">‚Üí</div>
                    <div class="upgrade-slot" id="target-slot">
                        <p style="color: #8b8ba7;">Item objetivo</p>
                    </div>
                </div>
                <div class="success-rate">
                    <h3 style="color: #667eea; margin-bottom: 0.5rem;">Probabilidad de √âxito</h3>
                    <p style="font-size: 2rem; font-weight: bold;" id="success-percentage">0%</p>
                    <div class="success-bar">
                        <div class="success-fill" id="success-fill" style="width: 0%"></div>
                    </div>
                </div>
                <button class="btn-primary" onclick="attemptUpgrade()" style="width: 100%; padding: 1rem; font-size: 1.2rem;" disabled id="upgrade-btn">Intentar Upgrade</button>
            </div>
        </div>
    </div>

    <div class="app-container" id="inventory-section">
        <div class="section-header">
            <h2>üéí INVENTARIO</h2>
        </div>
        <div class="inventory-grid" id="inventory-grid"></div>
    </div>

    <script>
        let gameState = {
            loggedIn: false,
            username: '',
            balance: 0,
            inventory: []
        };

        const cases = [
            { id: 1, name: 'Caja Starter', icon: 'üì¶', price: 10, items: [
                { name: 'Skin Com√∫n', icon: 'üîµ', value: 5, rarity: 'common' },
                { name: 'Skin Com√∫n Plus', icon: 'üîµ', value: 8, rarity: 'common' },
                { name: 'Skin Raro', icon: 'üü£', value: 15, rarity: 'rare' },
                { name: 'Skin √âpico', icon: 'üíú', value: 25, rarity: 'epic' }
            ]},
            { id: 2, name: 'Caja Legendaria', icon: 'üî•', price: 50, items: [
                { name: 'Skin Raro', icon: 'üü£', value: 30, rarity: 'rare' },
                { name: 'Skin √âpico', icon: 'üíú', value: 75, rarity: 'epic' },
                { name: 'Skin Legendario', icon: '‚≠ê', value: 150, rarity: 'legendary' },
                { name: 'Skin M√≠tico', icon: 'üåü', value: 300, rarity: 'legendary' }
            ]},
            { id: 3, name: 'Caja Elite', icon: 'üíé', price: 100, items: [
                { name: 'Skin √âpico', icon: 'üíú', value: 80, rarity: 'epic' },
                { name: 'Skin Legendario', icon: '‚≠ê', value: 200, rarity: 'legendary' },
                { name: 'Skin M√≠tico', icon: 'üåü', value: 500, rarity: 'legendary' },
                { name: 'Skin Divino', icon: '‚ú®', value: 1000, rarity: 'legendary' }
            ]},
            { id: 4, name: 'Caja Lightning', icon: '‚ö°', price: 30, items: [
                { name: 'Skin Com√∫n', icon: 'üîµ', value: 15, rarity: 'common' },
                { name: 'Skin Raro', icon: 'üü£', value: 40, rarity: 'rare' },
                { name: 'Skin √âpico', icon: 'üíú', value: 90, rarity: 'epic' },
                { name: 'Skin Legendario', icon: '‚≠ê', value: 180, rarity: 'legendary' }
            ]},
            { id: 5, name: 'Caja Imperial', icon: 'üëë', price: 150, items: [
                { name: 'Skin Legendario', icon: '‚≠ê', value: 250, rarity: 'legendary' },
                { name: 'Skin M√≠tico', icon: 'üåü', value: 600, rarity: 'legendary' },
                { name: 'Skin Divino', icon: '‚ú®', value: 1200, rarity: 'legendary' },
                { name: 'Skin Celestial', icon: 'üí´', value: 2500, rarity: 'legendary' }
            ]},
            { id: 6, name: 'Caja Estelar', icon: 'üåü', price: 80, items: [
                { name: 'Skin Raro', icon: 'üü£', value: 50, rarity: 'rare' },
                { name: 'Skin √âpico', icon: 'üíú', value: 120, rarity: 'epic' },
                { name: 'Skin Legendario', icon: '‚≠ê', value: 300, rarity: 'legendary' },
                { name: 'Skin M√≠tico', icon: 'üåü', value: 700, rarity: 'legendary' }
            ]}
        ];

        function init() {
            renderCases();
            updateBalance();
        }

        function showLoginModal() {
            document.getElementById('login-modal').classList.add('active');
        }

        function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            if (username && password) {
                gameState.loggedIn = true;
                gameState.username = username;
                gameState.balance = 5000;
                document.getElementById('login-modal').classList.remove('active');
                document.getElementById('login-btn').style.display = 'none';
                document.getElementById('logout-btn').style.display = 'block';
                document.getElementById('nav-menu').style.display = 'flex';
                updateBalance();
                showSection('cases');
            }
        }

        function register() {
            login();
        }

        function logout() {
            gameState = { loggedIn: false, username: '', balance: 0, inventory: [] };
            document.getElementById('login-btn').style.display = 'block';
            document.getElementById('logout-btn').style.display = 'none';
            document.getElementById('nav-menu').style.display = 'none';
            showHome();
        }

        function showHome() {
            document.querySelectorAll('.app-container').forEach(el => el.classList.remove('active'));
            document.getElementById('home-section').style.display = 'flex';
        }

        function showSection(section) {
            if (!gameState.loggedIn) {
                showLoginModal();
                return;
            }
            
            document.getElementById('home-section').style.display = 'none';
            document.querySelectorAll('.app-container').forEach(el => el.classList.remove('active'));
            document.getElementById(section + '-section').classList.add('active');
            
            if (section === 'inventory') {
                renderInventory();
            }
        }

        function updateBalance() {
            document.getElementById('user-balance').textContent = '$' + gameState.balance.toFixed(2);
        }

        function renderCases() {
            const grid = document.getElementById('cases-grid');
            grid.innerHTML = cases.map(c => `
                <div class="case-card" onclick="openCase(${c.id})">
                    <div class="case-image">${c.icon}</div>
                    <div class="case-name">${c.name}</div>
                    <div class="case-price">$${c.price}</div>
                    <button class="btn-primary" style="width: 100%;">ABRIR</button>
                </div>
            `).join('');
        }

        function openCase(caseId) {
            const caseData = cases.find(c => c.id === caseId);
            
            if (gameState.balance < caseData.price) {
                alert('Saldo insuficiente');
                return;
            }
            
            gameState.balance -= caseData.price;
            updateBalance();
            
            document.getElementById('opening-modal').classList.add('active');
            document.getElementById('result-container').classList.remove('active');
            
            const rouletteItems = [];
            for (let i = 0; i < 50; i++) {
                const item = caseData.items[Math.floor(Math.random() * caseData.items.length)];
                rouletteItems.push(item);
            }
            
            const weights = [50, 30, 15, 5];
            const random = Math.random() * 100;
            let winnerIndex = 0;
            let cumulative = 0;
            for (let i = 0; i < weights.length; i++) {
                cumulative += weights[i];
                if (random <= cumulative) {
                    winnerIndex = i;
                    break;
                }
            }
            const winner = caseData.items[winnerIndex];
            rouletteItems[45] = winner;
            
            const rouletteContainer = document.getElementById('roulette-items');
            rouletteContainer.innerHTML = rouletteItems.map(item => `
                <div class="roulette-item ${item.rarity}">
                    <div class="item-icon">${item.icon}</div>
                    <div class="item-name">${item.name}</div>
                    <div class="item-value">${item.value}</div>
                </div>
            `).join('');
            
            setTimeout(() => {
                const offset = -(45 * 166) + (window.innerWidth / 2) - 75;
                rouletteContainer.style.transform = `translateX(${offset}px)`;
            }, 100);
            
            setTimeout(() => {
                gameState.inventory.push({ ...winner, id: Date.now() });
                gameState.balance += winner.value;
                updateBalance();
                
                document.getElementById('result-icon').textContent = winner.icon;
                document.getElementById('result-name').textContent = winner.name;
                document.getElementById('result-value').textContent = '
                document.getElementById('result-container').classList.add('active');
            }, 3500);
        }

        function closeOpening() {
            document.getElementById('opening-modal').classList.remove('active');
            const rouletteContainer = document.getElementById('roulette-items');
            rouletteContainer.style.transform = 'translateX(0)';
            rouletteContainer.style.transition = 'none';
            setTimeout(() => {
                rouletteContainer.style.transition = 'transform 3s cubic-bezier(0.17, 0.67, 0.12, 0.99)';
            }, 50);
        }

        function startBattle(mode) {
            const arena = document.getElementById('battle-arena');
            arena.style.display = 'block';
            
            const opponents = mode === '1v1' ? 1 : mode === '2v2' ? 3 : Math.floor(Math.random() * 3) + 2;
            const playerValue = Math.random() * 500 + 100;
            const opponentValues = Array(opponents).fill(0).map(() => Math.random() * 500 + 100);
            
            arena.innerHTML = `
                <div class="battle-players">
                    <div class="player-side">
                        <div class="player-avatar">${gameState.username[0].toUpperCase()}</div>
                        <h3>${gameState.username}</h3>
                        <p style="color: #4ade80; font-size: 1.5rem; font-weight: bold;">${playerValue.toFixed(2)}</p>
                    </div>
                    <div class="vs-text">VS</div>
                    <div class="player-side">
                        <div class="player-avatar">ü§ñ</div>
                        <h3>Oponente</h3>
                        <p style="color: #f87171; font-size: 1.5rem; font-weight: bold;">${opponentValues[0].toFixed(2)}</p>
                    </div>
                </div>
                <div style="text-align: center; margin-top: 2rem;">
                    <div style="font-size: 1.5rem; color: #667eea;">‚öîÔ∏è Batalla en progreso...</div>
                </div>
            `;
            
            setTimeout(() => {
                const maxValue = Math.max(playerValue, ...opponentValues);
                const winner = playerValue === maxValue ? gameState.username : 'Oponente';
                
                if (winner === gameState.username) {
                    const prize = opponentValues.reduce((a, b) => a + b, 0);
                    gameState.balance += prize;
                    updateBalance();
                    alert('¬°Ganaste! + + prize.toFixed(2));
                } else {
                    gameState.balance -= playerValue;
                    updateBalance();
                    alert('Perdiste - + playerValue.toFixed(2));
                }
                
                arena.style.display = 'none';
            }, 3000);
        }

        let selectedUpgradeItem = null;

        function renderInventory() {
            const grid = document.getElementById('inventory-grid');
            
            if (gameState.inventory.length === 0) {
                grid.innerHTML = '<p style="grid-column: 1/-1; text-align: center; color: #8b8ba7; padding: 3rem;">Tu inventario est√° vac√≠o. ¬°Abre algunas cajas!</p>';
                return;
            }
            
            grid.innerHTML = gameState.inventory.map(item => `
                <div class="inventory-item" onclick="selectItem(${item.id})">
                    <div style="font-size: 3rem; margin-bottom: 0.5rem;">${item.icon}</div>
                    <div style="font-size: 0.9rem; margin-bottom: 0.3rem;">${item.name}</div>
                    <div style="color: #4ade80; font-weight: bold;">${item.value}</div>
                </div>
            `).join('');
        }

        function selectItem(itemId) {
            const item = gameState.inventory.find(i => i.id === itemId);
            
            if (document.getElementById('upgrade-section').classList.contains('active')) {
                selectedUpgradeItem = item;
                document.getElementById('item-slot').innerHTML = `
                    <div style="font-size: 3rem; margin-bottom: 0.5rem;">${item.icon}</div>
                    <div style="font-size: 1rem; margin-bottom: 0.3rem;">${item.name}</div>
                    <div style="color: #4ade80; font-weight: bold;">${item.value}</div>
                `;
                
                const targetValue = item.value * (Math.random() * 1.5 + 1.5);
                const successRate = Math.max(10, Math.min(90, (item.value / targetValue) * 100));
                
                const rarities = ['common', 'rare', 'epic', 'legendary'];
                const rarityIndex = Math.min(3, rarities.indexOf(item.rarity) + 1);
                const targetRarity = rarities[rarityIndex];
                
                const icons = { common: 'üîµ', rare: 'üü£', epic: 'üíú', legendary: '‚≠ê' };
                
                selectedUpgradeItem.target = {
                    name: item.name + ' Mejorado',
                    icon: icons[targetRarity],
                    value: targetValue,
                    rarity: targetRarity,
                    successRate: successRate
                };
                
                document.getElementById('target-slot').innerHTML = `
                    <div style="font-size: 3rem; margin-bottom: 0.5rem;">${selectedUpgradeItem.target.icon}</div>
                    <div style="font-size: 1rem; margin-bottom: 0.3rem;">${selectedUpgradeItem.target.name}</div>
                    <div style="color: #4ade80; font-weight: bold;">${selectedUpgradeItem.target.value.toFixed(2)}</div>
                `;
                
                document.getElementById('success-percentage').textContent = successRate.toFixed(1) + '%';
                document.getElementById('success-fill').style.width = successRate + '%';
                document.getElementById('upgrade-btn').disabled = false;
            } else {
                document.querySelectorAll('.inventory-item').forEach(el => el.classList.remove('selected'));
                event.target.closest('.inventory-item').classList.add('selected');
            }
        }

        function attemptUpgrade() {
            if (!selectedUpgradeItem) return;
            
            const success = Math.random() * 100 <= selectedUpgradeItem.target.successRate;
            
            gameState.inventory = gameState.inventory.filter(i => i.id !== selectedUpgradeItem.id);
            
            if (success) {
                gameState.inventory.push({
                    ...selectedUpgradeItem.target,
                    id: Date.now()
                });
                alert('¬°√âxito! Has obtenido ' + selectedUpgradeItem.target.name);
            } else {
                alert('¬°Fallaste! Has perdido ' + selectedUpgradeItem.name);
            }
            
            selectedUpgradeItem = null;
            document.getElementById('item-slot').innerHTML = '<p style="color: #8b8ba7;">Selecciona un item de tu inventario</p>';
            document.getElementById('target-slot').innerHTML = '<p style="color: #8b8ba7;">Item objetivo</p>';
            document.getElementById('success-percentage').textContent = '0%';
            document.getElementById('success-fill').style.width = '0%';
            document.getElementById('upgrade-btn').disabled = true;
            
            renderInventory();
        }

        init();
    </script>
</body>
</html> + winner.value;
                document.getElementById('result-container').classList.add('active');
            }, 3500);
        }

        function closeOpening() {
            document.getElementById('opening-modal').classList.remove('active');
            const rouletteContainer = document.getElementById('roulette-items');
            rouletteContainer.style.transform = 'translateX(0)';
            rouletteContainer.style.transition = 'none';
            setTimeout(() => {
                rouletteContainer.style.transition = 'transform 3s cubic-bezier(0.17, 0.67, 0.12, 0.99)';
            }, 50);
        }

        function startBattle(mode) {
            const arena = document.getElementById('battle-arena');
            arena.style.display = 'block';
            
            const opponents = mode === '1v1' ? 1 : mode === '2v2' ? 3 : Math.floor(Math.random() * 3) + 2;
            const playerValue = Math.random() * 500 + 100;
            const opponentValues = Array(opponents).fill(0).map(() => Math.random() * 500 + 100);
            
            arena.innerHTML = `
                <div class="battle-players">
                    <div class="player-side">
                        <div class="player-avatar">${gameState.username[0].toUpperCase()}</div>
                        <h3>${gameState.username}</h3>
                        <p style="color: #4ade80; font-size: 1.5rem; font-weight: bold;">${playerValue.toFixed(2)}</p>
                    </div>
                    <div class="vs-text">VS</div>
                    <div class="player-side">
                        <div class="player-avatar">ü§ñ</div>
                        <h3>Oponente</h3>
                        <p style="color: #f87171; font-size: 1.5rem; font-weight: bold;">${opponentValues[0].toFixed(2)}</p>
                    </div>
                </div>
                <div style="text-align: center; margin-top: 2rem;">
                    <div style="font-size: 1.5rem; color: #667eea;">‚öîÔ∏è Batalla en progreso...</div>
                </div>
            `;
            
            setTimeout(() => {
                const maxValue = Math.max(playerValue, ...opponentValues);
                const winner = playerValue === maxValue ? gameState.username : 'Oponente';
                
                if (winner === gameState.username) {
                    const prize = opponentValues.reduce((a, b) => a + b, 0);
                    gameState.balance += prize;
                    updateBalance();
                    alert('¬°Ganaste! + + prize.toFixed(2));
                } else {
                    gameState.balance -= playerValue;
                    updateBalance();
                    alert('Perdiste - + playerValue.toFixed(2));
                }
                
                arena.style.display = 'none';
            }, 3000);
        }

        let selectedUpgradeItem = null;

        function renderInventory() {
            const grid = document.getElementById('inventory-grid');
            
            if (gameState.inventory.length === 0) {
                grid.innerHTML = '<p style="grid-column: 1/-1; text-align: center; color: #8b8ba7; padding: 3rem;">Tu inventario est√° vac√≠o. ¬°Abre algunas cajas!</p>';
                return;
            }
            
            grid.innerHTML = gameState.inventory.map(item => `
                <div class="inventory-item" onclick="selectItem(${item.id})">
                    <div style="font-size: 3rem; margin-bottom: 0.5rem;">${item.icon}</div>
                    <div style="font-size: 0.9rem; margin-bottom: 0.3rem;">${item.name}</div>
                    <div style="color: #4ade80; font-weight: bold;">${item.value}</div>
                </div>
            `).join('');
        }

        function selectItem(itemId) {
            const item = gameState.inventory.find(i => i.id === itemId);
            
            if (document.getElementById('upgrade-section').classList.contains('active')) {
                selectedUpgradeItem = item;
                document.getElementById('item-slot').innerHTML = `
                    <div style="font-size: 3rem; margin-bottom: 0.5rem;">${item.icon}</div>
                    <div style="font-size: 1rem; margin-bottom: 0.3rem;">${item.name}</div>
                    <div style="color: #4ade80; font-weight: bold;">${item.value}</div>
                `;
                
                const targetValue = item.value * (Math.random() * 1.5 + 1.5);
                const successRate = Math.max(10, Math.min(90, (item.value / targetValue) * 100));
                
                const rarities = ['common', 'rare', 'epic', 'legendary'];
                const rarityIndex = Math.min(3, rarities.indexOf(item.rarity) + 1);
                const targetRarity = rarities[rarityIndex];
                
                const icons = { common: 'üîµ', rare: 'üü£', epic: 'üíú', legendary: '‚≠ê' };
                
                selectedUpgradeItem.target = {
                    name: item.name + ' Mejorado',
                    icon: icons[targetRarity],
                    value: targetValue,
                    rarity: targetRarity,
                    successRate: successRate
                };
                
                document.getElementById('target-slot').innerHTML = `
                    <div style="font-size: 3rem; margin-bottom: 0.5rem;">${selectedUpgradeItem.target.icon}</div>
                    <div style="font-size: 1rem; margin-bottom: 0.3rem;">${selectedUpgradeItem.target.name}</div>
                    <div style="color: #4ade80; font-weight: bold;">${selectedUpgradeItem.target.value.toFixed(2)}</div>
                `;
                
                document.getElementById('success-percentage').textContent = successRate.toFixed(1) + '%';
                document.getElementById('success-fill').style.width = successRate + '%';
                document.getElementById('upgrade-btn').disabled = false;
            } else {
                document.querySelectorAll('.inventory-item').forEach(el => el.classList.remove('selected'));
                event.target.closest('.inventory-item').classList.add('selected');
            }
        }

        function attemptUpgrade() {
            if (!selectedUpgradeItem) return;
            
            const success = Math.random() * 100 <= selectedUpgradeItem.target.successRate;
            
            gameState.inventory = gameState.inventory.filter(i => i.id !== selectedUpgradeItem.id);
            
            if (success) {
                gameState.inventory.push({
                    ...selectedUpgradeItem.target,
                    id: Date.now()
                });
                alert('¬°√âxito! Has obtenido ' + selectedUpgradeItem.target.name);
            } else {
                alert('¬°Fallaste! Has perdido ' + selectedUpgradeItem.name);
            }
            
            selectedUpgradeItem = null;
            document.getElementById('item-slot').innerHTML = '<p style="color: #8b8ba7;">Selecciona un item de tu inventario</p>';
            document.getElementById('target-slot').innerHTML = '<p style="color: #8b8ba7;">Item objetivo</p>';
            document.getElementById('success-percentage').textContent = '0%';
            document.getElementById('success-fill').style.width = '0%';
            document.getElementById('upgrade-btn').disabled = true;
            
            renderInventory();
        }

        init();
    </script>
</body>
</html>
